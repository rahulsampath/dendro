%Morton ordered. Correct Laplacian, Mass Matrix Stencils.
%X right, Y Back Z top
%1-based indexing
%J1 = gradPhi_i*gradPhi_j
%J2 = Phi_i*Phi_j
%K1 = J1*192/h;
%K2 = J2*1728/(h^3);
%dzdx dydz dxdy dz dx dy
%6 7 4 5 2 3
v= [0 0 0 0 0 0;
0 0 0 0 0 1;
0 0 0 0 1 0;
0 0 0 0 1 1;
0 0 0 1 0 0;
0 0 0 1 0 1;
0 0 0 1 1 0;
0 0 0 1 1 1;
0 0 1 0 1 1;
0 0 1 1 1 1;
0 1 0 1 0 1;
0 1 0 1 1 1;
0 1 1 1 1 1;
1 0 0 1 1 0;
1 0 0 1 1 1;
1 0 1 1 1 1;
1 1 0 1 1 1;
1 1 1 1 1 1];

%Morton Order: X first Y second Z last
XYZ = [x1 y1 z1;
      (x1+hx) y1 z1;      
      x1 (y1+hy) z1;
      (x1+hx) (y1+hy) z1;
      x1 y1 (z1+hz);
      (x1+hx) y1 (z1+hz);         
      x1 (y1+hy) (z1+hz)
      (x1+hx) (y1+hy) (z1+hz) ];

detJac = 1/8*hx*hy*hz
  
 
K1(:,:,1) = 
 
[  64,   0,   0, -16,   0, -16, -16, -16]
[   0,  64, -16,   0, -16,   0, -16, -16]
[   0, -16,  64,   0, -16, -16,   0, -16]
[ -16,   0,   0,  64, -16, -16, -16,   0]
[   0, -16, -16, -16,  64,   0,   0, -16]
[ -16,   0, -16, -16,   0,  64, -16,   0]
[ -16, -16,   0, -16,   0, -16,  64,   0]
[ -16, -16, -16,   0, -16,   0,   0,  64]
 
 
K1(:,:,2) = 
 
[  80,  -8,  16, -16,  -8, -24, -16, -24]
[  -8,  64,  -8,   0, -16,   0, -16, -16]
[  16,  -8,  16,   0,  -8,  -8,   0,  -8]
[ -16,   0,   0,  64, -16, -16, -16,   0]
[  -8, -16,  -8, -16,  64,   0,   0, -16]
[ -24,   0,  -8, -16,   0,  64, -16,   0]
[ -16, -16,   0, -16,   0, -16,  64,   0]
[ -24, -16,  -8,   0, -16,   0,   0,  64]
 
 
K1(:,:,3) = 
 
[  80,  16,  -8, -16,  -8, -16, -24, -24]
[  16,  16,  -8,   0,  -8,   0,  -8,  -8]
[  -8,  -8,  64,   0, -16, -16,   0, -16]
[ -16,   0,   0,  64, -16, -16, -16,   0]
[  -8,  -8, -16, -16,  64,   0,   0, -16]
[ -16,   0, -16, -16,   0,  64, -16,   0]
[ -24,  -8,   0, -16,   0, -16,  64,   0]
[ -24,  -8, -16,   0, -16,   0,   0,  64]
 
 
K1(:,:,4) = 
 
[  88,  12,  12, -16, -16, -24, -24, -32]
[  12,  16,  -4,   0,  -8,   0,  -8,  -8]
[  12,  -4,  16,   0,  -8,  -8,   0,  -8]
[ -16,   0,   0,  64, -16, -16, -16,   0]
[ -16,  -8,  -8, -16,  64,   0,   0, -16]
[ -24,   0,  -8, -16,   0,  64, -16,   0]
[ -24,  -8,   0, -16,   0, -16,  64,   0]
[ -32,  -8,  -8,   0, -16,   0,   0,  64]
 
 
K1(:,:,5) = 
 
[  80,  -8,  -8, -24,  16, -16, -16, -24]
[  -8,  64, -16,   0,  -8,   0, -16, -16]
[  -8, -16,  64,   0,  -8, -16,   0, -16]
[ -24,   0,   0,  64,  -8, -16, -16,   0]
[  16,  -8,  -8,  -8,  16,   0,   0,  -8]
[ -16,   0, -16, -16,   0,  64, -16,   0]
[ -16, -16,   0, -16,   0, -16,  64,   0]
[ -24, -16, -16,   0,  -8,   0,   0,  64]
 
 
K1(:,:,6) = 
 
[  88, -16,  12, -24,  12, -24, -16, -32]
[ -16,  64,  -8,   0,  -8,   0, -16, -16]
[  12,  -8,  16,   0,  -4,  -8,   0,  -8]
[ -24,   0,   0,  64,  -8, -16, -16,   0]
[  12,  -8,  -4,  -8,  16,   0,   0,  -8]
[ -24,   0,  -8, -16,   0,  64, -16,   0]
[ -16, -16,   0, -16,   0, -16,  64,   0]
[ -32, -16,  -8,   0,  -8,   0,   0,  64]
 
 
K1(:,:,7) = 
 
[  88,  12, -16, -24,  12, -16, -24, -32]
[  12,  16,  -8,   0,  -4,   0,  -8,  -8]
[ -16,  -8,  64,   0,  -8, -16,   0, -16]
[ -24,   0,   0,  64,  -8, -16, -16,   0]
[  12,  -4,  -8,  -8,  16,   0,   0,  -8]
[ -16,   0, -16, -16,   0,  64, -16,   0]
[ -24,  -8,   0, -16,   0, -16,  64,   0]
[ -32,  -8, -16,   0,  -8,   0,   0,  64]
 
 
K1(:,:,8) = 
 
[  88,   8,   8, -24,   8, -24, -24, -40]
[   8,  16,  -4,   0,  -4,   0,  -8,  -8]
[   8,  -4,  16,   0,  -4,  -8,   0,  -8]
[ -24,   0,   0,  64,  -8, -16, -16,   0]
[   8,  -4,  -4,  -8,  16,   0,   0,  -8]
[ -24,   0,  -8, -16,   0,  64, -16,   0]
[ -24,  -8,   0, -16,   0, -16,  64,   0]
[ -40,  -8,  -8,   0,  -8,   0,   0,  64]
 
 
K1(:,:,9) = 
 
[  84,  12,  12,   0, -20, -28, -28, -32]
[  12,  20,   0,   4, -12,  -4, -12,  -8]
[  12,   0,  20,   4, -12, -12,  -4,  -8]
[   0,   4,   4,   4,  -4,  -4,  -4,   0]
[ -20, -12, -12,  -4,  64,   0,   0, -16]
[ -28,  -4, -12,  -4,   0,  64, -16,   0]
[ -28, -12,  -4,  -4,   0, -16,  64,   0]
[ -32,  -8,  -8,   0, -16,   0,   0,  64]
 
 
K1(:,:,10) = 
 
[  80,   6,   6,  -2,   6, -28, -28, -40]
[   6,  20,   0,   4,  -6,  -4, -12,  -8]
[   6,   0,  20,   4,  -6, -12,  -4,  -8]
[  -2,   4,   4,   4,  -2,  -4,  -4,   0]
[   6,  -6,  -6,  -2,  16,   0,   0,  -8]
[ -28,  -4, -12,  -4,   0,  64, -16,   0]
[ -28, -12,  -4,  -4,   0, -16,  64,   0]
[ -40,  -8,  -8,   0,  -8,   0,   0,  64]
 
 
K1(:,:,11) = 
 
[  84, -20,  12, -28,  12, -28,   0, -32]
[ -20,  64, -12,   0, -12,   0,  -4, -16]
[  12, -12,  20,  -4,   0, -12,   4,  -8]
[ -28,   0,  -4,  64, -12, -16,  -4,   0]
[  12, -12,   0, -12,  20,  -4,   4,  -8]
[ -28,   0, -12, -16,  -4,  64,  -4,   0]
[   0,  -4,   4,  -4,   4,  -4,   4,   0]
[ -32, -16,  -8,   0,  -8,   0,   0,  64]
 
 
K1(:,:,12) = 
 
[  80,   6,   6, -28,   6, -28,  -2, -40]
[   6,  16,  -6,   0,  -6,   0,  -2,  -8]
[   6,  -6,  20,  -4,   0, -12,   4,  -8]
[ -28,   0,  -4,  64, -12, -16,  -4,   0]
[   6,  -6,   0, -12,  20,  -4,   4,  -8]
[ -28,   0, -12, -16,  -4,  64,  -4,   0]
[  -2,  -2,   4,  -4,   4,  -4,   4,   0]
[ -40,  -8,  -8,   0,  -8,   0,   0,  64]
 
 
K1(:,:,13) = 
 
[  70,   3,   2,  -3,   3, -32,  -3, -40]
[   3,  20,  -3,   4,  -9,  -4,  -3,  -8]
[   2,  -3,  22,   3,  -3, -16,   3,  -8]
[  -3,   4,   3,   4,  -3,  -4,  -1,   0]
[   3,  -9,  -3,  -3,  20,  -4,   4,  -8]
[ -32,  -4, -16,  -4,  -4,  64,  -4,   0]
[  -3,  -3,   3,  -1,   4,  -4,   4,   0]
[ -40,  -8,  -8,   0,  -8,   0,   0,  64]
 
 
K1(:,:,14) = 
 
[  84,  12, -20, -28,  12,   0, -28, -32]
[  12,  20, -12,  -4,   0,   4, -12,  -8]
[ -20, -12,  64,   0, -12,  -4,   0, -16]
[ -28,  -4,   0,  64, -12,  -4, -16,   0]
[  12,   0, -12, -12,  20,   4,  -4,  -8]
[   0,   4,  -4,  -4,   4,   4,  -4,   0]
[ -28, -12,   0, -16,  -4,  -4,  64,   0]
[ -32,  -8, -16,   0,  -8,   0,   0,  64]
 
 
K1(:,:,15) = 
 
[  80,   6,   6, -28,   6,  -2, -28, -40]
[   6,  20,  -6,  -4,   0,   4, -12,  -8]
[   6,  -6,  16,   0,  -6,  -2,   0,  -8]
[ -28,  -4,   0,  64, -12,  -4, -16,   0]
[   6,   0,  -6, -12,  20,   4,  -4,  -8]
[  -2,   4,  -2,  -4,   4,   4,  -4,   0]
[ -28, -12,   0, -16,  -4,  -4,  64,   0]
[ -40,  -8,  -8,   0,  -8,   0,   0,  64]
 
 
K1(:,:,16) = 
 
[  70,   2,   3,  -3,   3,  -3, -32, -40]
[   2,  22,  -3,   3,  -3,   3, -16,  -8]
[   3,  -3,  20,   4,  -9,  -3,  -4,  -8]
[  -3,   3,   4,   4,  -3,  -1,  -4,   0]
[   3,  -3,  -9,  -3,  20,   4,  -4,  -8]
[  -3,   3,  -3,  -1,   4,   4,  -4,   0]
[ -32, -16,  -4,  -4,  -4,  -4,  64,   0]
[ -40,  -8,  -8,   0,  -8,   0,   0,  64]
 
 
K1(:,:,17) = 
 
[  70,   3,   3, -32,   2,  -3,  -3, -40]
[   3,  20,  -9,  -4,  -3,   4,  -3,  -8]
[   3,  -9,  20,  -4,  -3,  -3,   4,  -8]
[ -32,  -4,  -4,  64, -16,  -4,  -4,   0]
[   2,  -3,  -3, -16,  22,   3,   3,  -8]
[  -3,   4,  -3,  -4,   3,   4,  -1,   0]
[  -3,  -3,   4,  -4,   3,  -1,   4,   0]
[ -40,  -8,  -8,   0,  -8,   0,   0,  64]
 
 
K1(:,:,18) = 
 
[  58,  -2,  -2,  -4,  -2,  -4,  -4, -40]
[  -2,  22,  -7,   3,  -7,   3,  -4,  -8]
[  -2,  -7,  22,   3,  -7,  -4,   3,  -8]
[  -4,   3,   3,   4,  -4,  -1,  -1,   0]
[  -2,  -7,  -7,  -4,  22,   3,   3,  -8]
[  -4,   3,  -4,  -1,   3,   4,  -1,   0]
[  -4,  -4,   3,  -1,   3,  -1,   4,   0]
[ -40,  -8,  -8,   0,  -8,   0,   0,  64]
 
 

 
 
K2(:,:,1) = 
 
[ 64, 32, 32, 16, 32, 16, 16,  8]
[ 32, 64, 16, 32, 16, 32,  8, 16]
[ 32, 16, 64, 32, 16,  8, 32, 16]
[ 16, 32, 32, 64,  8, 16, 16, 32]
[ 32, 16, 16,  8, 64, 32, 32, 16]
[ 16, 32,  8, 16, 32, 64, 16, 32]
[ 16,  8, 32, 16, 32, 16, 64, 32]
[  8, 16, 16, 32, 16, 32, 32, 64]
 
 
K2(:,:,2) = 
 
[ 112,  40,  32,  32,  40,  20,  32,  16]
[  40,  64,   8,  32,  16,  32,   8,  16]
[  32,   8,  16,  16,   8,   4,  16,   8]
[  32,  32,  16,  64,   8,  16,  16,  32]
[  40,  16,   8,   8,  64,  32,  32,  16]
[  20,  32,   4,  16,  32,  64,  16,  32]
[  32,   8,  16,  16,  32,  16,  64,  32]
[  16,  16,   8,  32,  16,  32,  32,  64]
 
 
K2(:,:,3) = 
 
[ 112,  32,  40,  32,  40,  32,  20,  16]
[  32,  16,   8,  16,   8,  16,   4,   8]
[  40,   8,  64,  32,  16,   8,  32,  16]
[  32,  16,  32,  64,   8,  16,  16,  32]
[  40,   8,  16,   8,  64,  32,  32,  16]
[  32,  16,   8,  16,  32,  64,  16,  32]
[  20,   4,  32,  16,  32,  16,  64,  32]
[  16,   8,  16,  32,  16,  32,  32,  64]
 
 
K2(:,:,4) = 
 
[ 168,  36,  36,  48,  48,  36,  36,  24]
[  36,  16,   4,  16,   8,  16,   4,   8]
[  36,   4,  16,  16,   8,   4,  16,   8]
[  48,  16,  16,  64,   8,  16,  16,  32]
[  48,   8,   8,   8,  64,  32,  32,  16]
[  36,  16,   4,  16,  32,  64,  16,  32]
[  36,   4,  16,  16,  32,  16,  64,  32]
[  24,   8,   8,  32,  16,  32,  32,  64]
 
 
K2(:,:,5) = 
 
[ 112,  40,  40,  20,  32,  32,  32,  16]
[  40,  64,  16,  32,   8,  32,   8,  16]
[  40,  16,  64,  32,   8,   8,  32,  16]
[  20,  32,  32,  64,   4,  16,  16,  32]
[  32,   8,   8,   4,  16,  16,  16,   8]
[  32,  32,   8,  16,  16,  64,  16,  32]
[  32,   8,  32,  16,  16,  16,  64,  32]
[  16,  16,  16,  32,   8,  32,  32,  64]
 
 
K2(:,:,6) = 
 
[ 168,  48,  36,  36,  36,  36,  48,  24]
[  48,  64,   8,  32,   8,  32,   8,  16]
[  36,   8,  16,  16,   4,   4,  16,   8]
[  36,  32,  16,  64,   4,  16,  16,  32]
[  36,   8,   4,   4,  16,  16,  16,   8]
[  36,  32,   4,  16,  16,  64,  16,  32]
[  48,   8,  16,  16,  16,  16,  64,  32]
[  24,  16,   8,  32,   8,  32,  32,  64]
 
 
K2(:,:,7) = 
 
[ 168,  36,  48,  36,  36,  48,  36,  24]
[  36,  16,   8,  16,   4,  16,   4,   8]
[  48,   8,  64,  32,   8,   8,  32,  16]
[  36,  16,  32,  64,   4,  16,  16,  32]
[  36,   4,   8,   4,  16,  16,  16,   8]
[  48,  16,   8,  16,  16,  64,  16,  32]
[  36,   4,  32,  16,  16,  16,  64,  32]
[  24,   8,  16,  32,   8,  32,  32,  64]
 
 
K2(:,:,8) = 
 
[ 232,  40,  40,  52,  40,  52,  52,  32]
[  40,  16,   4,  16,   4,  16,   4,   8]
[  40,   4,  16,  16,   4,   4,  16,   8]
[  52,  16,  16,  64,   4,  16,  16,  32]
[  40,   4,   4,   4,  16,  16,  16,   8]
[  52,  16,   4,  16,  16,  64,  16,  32]
[  52,   4,  16,  16,  16,  16,  64,  32]
[  32,   8,   8,  32,   8,  32,  32,  64]
 
 
K2(:,:,9) = 
 
[ 196,  56,  56,  16,  50,  40,  40,  32]
[  56,  28,  16,   8,  10,  20,   8,  16]
[  56,  16,  28,   8,  10,   8,  20,  16]
[  16,   8,   8,   4,   2,   4,   4,   8]
[  50,  10,  10,   2,  64,  32,  32,  16]
[  40,  20,   8,   4,  32,  64,  16,  32]
[  40,   8,  20,   4,  32,  16,  64,  32]
[  32,  16,  16,   8,  16,  32,  32,  64]
 
 
K2(:,:,10) = 
 
[ 262,  61,  61,  17,  41,  56,  56,  40]
[  61,  28,  16,   8,   5,  20,   8,  16]
[  61,  16,  28,   8,   5,   8,  20,  16]
[  17,   8,   8,   4,   1,   4,   4,   8]
[  41,   5,   5,   1,  16,  16,  16,   8]
[  56,  20,   8,   4,  16,  64,  16,  32]
[  56,   8,  20,   4,  16,  16,  64,  32]
[  40,  16,  16,   8,   8,  32,  32,  64]
 
 
K2(:,:,11) = 
 
[ 196,  50,  56,  40,  56,  40,  16,  32]
[  50,  64,  10,  32,  10,  32,   2,  16]
[  56,  10,  28,  20,  16,   8,   8,  16]
[  40,  32,  20,  64,   8,  16,   4,  32]
[  56,  10,  16,   8,  28,  20,   8,  16]
[  40,  32,   8,  16,  20,  64,   4,  32]
[  16,   2,   8,   4,   8,   4,   4,   8]
[  32,  16,  16,  32,  16,  32,   8,  64]
 
 
K2(:,:,12) = 
 
[ 262,  41,  61,  56,  61,  56,  17,  40]
[  41,  16,   5,  16,   5,  16,   1,   8]
[  61,   5,  28,  20,  16,   8,   8,  16]
[  56,  16,  20,  64,   8,  16,   4,  32]
[  61,   5,  16,   8,  28,  20,   8,  16]
[  56,  16,   8,  16,  20,  64,   4,  32]
[  17,   1,   8,   4,   8,   4,   4,   8]
[  40,   8,  16,  32,  16,  32,   8,  64]
 
 
K2(:,:,13) = 
 
[ 294,  63,  84,  18,  63,  60,  18,  48]
[  63,  28,  18,   8,   7,  20,   2,  16]
[  84,  18,  42,   9,  18,  12,   9,  24]
[  18,   8,   9,   4,   2,   4,   1,   8]
[  63,   7,  18,   2,  28,  20,   8,  16]
[  60,  20,  12,   4,  20,  64,   4,  32]
[  18,   2,   9,   1,   8,   4,   4,   8]
[  48,  16,  24,   8,  16,  32,   8,  64]
 
 
K2(:,:,14) = 
 
[ 196,  56,  50,  40,  56,  16,  40,  32]
[  56,  28,  10,  20,  16,   8,   8,  16]
[  50,  10,  64,  32,  10,   2,  32,  16]
[  40,  20,  32,  64,   8,   4,  16,  32]
[  56,  16,  10,   8,  28,   8,  20,  16]
[  16,   8,   2,   4,   8,   4,   4,   8]
[  40,   8,  32,  16,  20,   4,  64,  32]
[  32,  16,  16,  32,  16,   8,  32,  64]
 
 
K2(:,:,15) = 
 
[ 262,  61,  41,  56,  61,  17,  56,  40]
[  61,  28,   5,  20,  16,   8,   8,  16]
[  41,   5,  16,  16,   5,   1,  16,   8]
[  56,  20,  16,  64,   8,   4,  16,  32]
[  61,  16,   5,   8,  28,   8,  20,  16]
[  17,   8,   1,   4,   8,   4,   4,   8]
[  56,   8,  16,  16,  20,   4,  64,  32]
[  40,  16,   8,  32,  16,   8,  32,  64]
 
 
K2(:,:,16) = 
 
[ 294,  84,  63,  18,  63,  18,  60,  48]
[  84,  42,  18,   9,  18,   9,  12,  24]
[  63,  18,  28,   8,   7,   2,  20,  16]
[  18,   9,   8,   4,   2,   1,   4,   8]
[  63,  18,   7,   2,  28,   8,  20,  16]
[  18,   9,   2,   1,   8,   4,   4,   8]
[  60,  12,  20,   4,  20,   4,  64,  32]
[  48,  24,  16,   8,  16,   8,  32,  64]
 
 
K2(:,:,17) = 
 
[ 294,  63,  63,  60,  84,  18,  18,  48]
[  63,  28,   7,  20,  18,   8,   2,  16]
[  63,   7,  28,  20,  18,   2,   8,  16]
[  60,  20,  20,  64,  12,   4,   4,  32]
[  84,  18,  18,  12,  42,   9,   9,  24]
[  18,   8,   2,   4,   9,   4,   1,   8]
[  18,   2,   8,   4,   9,   1,   4,   8]
[  48,  16,  16,  32,  24,   8,   8,  64]
 
 
K2(:,:,18) = 
 
[ 328,  87,  87,  19,  87,  19,  19,  56]
[  87,  42,  21,   9,  21,   9,   3,  24]
[  87,  21,  42,   9,  21,   3,   9,  24]
[  19,   9,   9,   4,   3,   1,   1,   8]
[  87,  21,  21,   3,  42,   9,   9,  24]
[  19,   9,   3,   1,   9,   4,   1,   8]
[  19,   3,   9,   1,   9,   1,   4,   8]
[  56,  24,  24,   8,  24,   8,   8,  64]
 
 
